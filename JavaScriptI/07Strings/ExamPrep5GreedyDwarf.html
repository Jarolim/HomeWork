<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
</head>
<script>
    function Solve(args) {
        //read
        var field = args[0].split(", ");

        for (var i = 0; i < field.length; i++) {
            field[i] = parseInt(field[i]);
        }

        var patternsCount = parseInt(args[1]);

        var patterns = [];

        for (var i = 0; i < patternsCount; i++) {
            var currentPattern = args[2 + i].split(', ');

            for (var inputPatternIndex = 0; inputPatternIndex < currentPattern.length; inputPatternIndex++) {
                currentPattern[inputPatternIndex] = parseInt(currentPattern[inputPatternIndex]);
            }
            patterns.push(currentPattern);


        }

        //implement
        var maxSum = Number.MIN_VALUE;

        for (var currentPatternIndex = 0; currentPatternIndex < patterns.length; currentPatternIndex++) {

            var currentStepIndex = 0;
            var visited = {};
            var fieldIndex = 0;
            var sum = 0;

            while (fieldIndex >= 0 && fieldIndex < field.length && !visited[fieldIndex]) {

                sum += field[fieldIndex];
                visited[fieldIndex] = true;

                fieldIndex = fieldIndex + patterns[currentPatternIndex][currentStepIndex];

                currentStepIndex++;
                if (currentStepIndex == patterns[currentPatternIndex].length) {
                    currentStepIndex = 0;
                }
            }

            if (maxSum < sum) {
                maxSum = sum;
            }
        }
        return maxSum;
    }


    function HandleSolveIO() {
        var args = [];

        args[0] = "1, 3, -6, 7, 4, 1, 12";
        args[1] = "3";
        args[2] = "1, 2, -3";
        args[3] = "1, 3, -2";
        args[4] = "1, -1";

        console.log(Solve(args));
    }

</script>
<body onload ="HandleSolveIO()">
    
</body>
</html>
